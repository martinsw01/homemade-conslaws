{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Conservation Laws","text":""},{"location":"#homemade-conslaws","title":"Homemade Conslaws","text":""},{"location":"#conservation-laws","title":"Conservation laws","text":"<p>Let \\(\\boldsymbol U\\) be a quantity defined on a domain \\(\\Omega \\subset \\R^n\\). For any subdomain \\(\\omega \\subset \\Omega\\), the temporal rate of change of \\(\\bm U\\) is equal to the amount of \\(\\bm U\\) created or destroyed and the flux going through the boundary \\(\\partial \\omega\\). It can be described mathematically by</p> \\[     \\dv{t} \\int_{\\omega} \\bm U \\dd \\x     = - \\int_{\\partial \\omega} \\bm F \\cdot \\bm \\nu \\dd \\s     + \\int_{\\omega} \\bm S \\dd \\x, \\] <p>where \\(\\bm F\\) is the flux and \\(\\bm S\\) is the source term. By the Gauss divergence theorem, we can rewrite this as</p> \\[     \\dv{t} \\int_{\\omega} \\bm U \\dd \\x     + \\int_{\\omega} \\div {\\bm F} \\dd \\x     = \\int_{\\omega} \\bm S \\dd \\x. \\] <p>Since this equation holds for all subdomains \\(\\omega \\subseteq \\Omega\\), we can write</p> \\[     \\bm U_t + \\div {\\bm F} = \\bm S \\quad \\text{ in } \\Omega \\times \\R_+ \\] <p>We call this equation a conservation law.</p>"},{"location":"theory/linear_transport_eqs/","title":"Linear transport equations","text":""},{"location":"theory/linear_transport_eqs/#linear-transport-equations","title":"Linear transport equations","text":"<p>The simplest case of the one-dimensional version of the transport equation,</p> \\[ \\begin{equation}     U_t + a(x, t) U_x = 0 \\quad \\text{ in } \\R \\times \\R_+, \\label{eq:transport} \\end{equation} \\] <p>is when the velocity field \\(a\\) is constant. The Cauchy problem is solved using the method of characteristics, where the solution is constant along the characteristic curves \\(x = x_0 + a t\\). The solution is then</p> \\[ \\begin{equation}     U(x, t) = U_0(x - a t) \\label{eq:transport_const} \\end{equation} \\] <p>for any \\((x,t) \\in \\R \\times \\R_+\\). We see that the initial data is transported with the velocity \\(a\\). For more general cases, the characteristics may not be possible to solve explicitly. However, we can obtain some information of the sulutions with the following a priori energy estimate:</p> <p>Lemma</p> <p>Assume \\(U\\) is a smooth solution of the transport equation decaying to zero at infinity for all \\(t \\in R_+\\) and \\(a \\in C^1(\\R, \\R_+)\\). Then, \\(U\\) satisfies the energy bound</p> \\[     \\int_{\\R} U^2(x, t) \\dd x \\leq e^{\\norm{a}_{C^1}t} \\int_\\R U_0^2(x) \\dd x. \\] Proof <p>Follows by multiplying the transport equation by \\(U\\) and integrating over space. Then, use that \\(U\\) decays to zero at infinity and apply Gr\u00f6nwall's inequality.</p> <p>The lemma shows that the energy is bounded. Using another functional, the assumptions on \\(U\\) can be relaxed:</p> <p>Lemma</p> <p>Assume \\(U\\) is a smooth bounded solution of the transport equation. Then, we have</p> \\[     \\sup_{x \\in \\R} \\abs{U(x, t)} \\leq \\norm{U_0}_{L^\\infty(\\R)} \\] <p>for any \\(t &gt; 0\\). </p> Proof <p>For any \\((x, t) \\in \\R \\times \\R_+\\), there exists \\(\\xi \\in \\R\\) such that \\(U(x, t) = U_0(\\xi)\\)</p> <p></p> <p></p>"},{"location":"theory/linear_transport_eqs/#finite-difference-schemes-for-the-transport-equation","title":"Finite difference schemes for the transport equation","text":"<p>For some velocity fields \\(a(x,t)\\), it may not be possible to derive an explicit formula for the characteristic equation. We thus use numerical methods to approximate the solutions of the transport equation.</p> <p></p> <p></p>"},{"location":"theory/linear_transport_eqs/#discretization","title":"Discretization","text":"<p>For simplicity, assume that the velocity field is positive. AS \\(\\R\\) is unbounded, we truncate the domain into \\(\\Omega = [x_L, X_R]\\). Thus, we must impose boundary conditions, which will be discussed below. For simplicity, we use a uniform mesh of mesh size \\(\\Delta x\\) with \\(N+1\\) points \\(x_j\\):</p> \\[     x_L = x_0 &lt; x_1 &lt; \\cdots &lt; x_N = x_R \\] <p>We further choose some terminal time \\(T\\) and divide into \\(M+1\\) points \\(t^n = n \\Delta t\\). We set the initial approximaition \\(U_j^0 := U_0(x_j)\\) and update the next approximation \\(U_j^{n+1}\\) using a finite difference scheme.</p> <p></p> <p></p>"},{"location":"theory/linear_transport_eqs/#centered-finite-difference-scheme","title":"Centered finite difference scheme","text":"<p>One such scheme is the forward difference in time and cetral difference in space approximating \\((\\ref{eq:transport_const})\\):</p> \\[     \\frac{U_j^{n+1} - U_j^n}{\\Delta t} + \\frac{a(U_{j+1}^n - U_{j-1}^n)}{2 \\Delta x} = 0,     \\quad 0 &lt; j &lt; N. \\] <p></p> <p></p>"},{"location":"theory/linear_transport_eqs/#example","title":"Example","text":"<p>We consider the domain \\([0, 1]\\) with initial data</p> \\[     U_0(x) = \\sin(2\\pi x) \\] <pre><code>u0(x) = sin(2*pi*x)\n</code></pre> <p>and \\(a = 1\\). Since the data is periodic, we impose periodic boundary conditions. Numerically, we implement this by setting</p> \\[     U_{0}^n = U_N^n, \\quad U_{N+1}^n = U_1^n \\] <p>Thus, on the boundary, \\(j = 0, N\\), we have</p> \\[ \\begin{align*}     \\frac{U_1^{n+1} - U_1^n}{\\Delta t} + \\frac{a(U_2^n - U_N^n)}{2 \\Delta x} = 0, \\\\     \\frac{U_N^{n+1} - U_N^n}{\\Delta t} + \\frac{a(U_1^n - U_{N-1}^n)}{2 \\Delta x} = 0. \\end{align*} \\] <p>For the first time step \\(n = 1\\), we have</p> \\[ \\begin{equation}     U_j^1 = U_0(x_j) - \\frac{\\Delta t}{2 \\Delta x} (U_0(x_{j+1}) - U_0(x_{j-1})) \\label{eq:transport_first} \\end{equation} \\] <p>Using a grid of \\(50\\) mesh points, simulating to time \\(T = 3\\), we get the following result:</p> <pre><code>x_L, x_R = 0, 1\nT = 3\nN = 100\ndx = (x_R - x_L)/N\ndt = 1 * dx\n\nx = x_L+dx:dx:x_R\nt = dt:dt:T\n\nU = central_difference.central_difference_scheme(x, t, u0)\n\nViz.animate_solution(U,\n                     (x, t) -&gt; u0(x-t),\n                     x, t)\n</code></pre> <p></p> <p>After some time, the solution diverges. Intuitively, the information should propagate from left to right. However, the scheme uses information from both sides. This can be explained rigorously using the the discrete energy</p> \\[     E^n = \\frac{1}{2} \\Delta x \\sum_j (U_j^n)^2. \\] <p>We know that the exact solution have bounded energy. We say that a scheme is energy stable if \\(E^n \\leq E^0\\) for all \\(n\\).</p> <p>Lemma</p> <p>Let \\(U_j^n\\) be the solutions computed with the central difference scheme. Then, we have the  following dicsrete energy estimate:</p> \\[     E^{n+1} = E^n + \\frac{\\Delta x}{2} \\sum_j (U_j^{n+1} - U_j^n)^2 \\] <p>Thus, the energy grows at each time step for any choice of \\(\\Delta x\\) and \\(\\Delta t\\).</p> Proof <p>Similar to the proof of the continuous energy estimate and using the identity</p> \\[     d_2(d_1 - d_2) = \\frac{1}{2}\\qty(d_1^2 - d_2^2) \\] <p></p> <p></p>"},{"location":"theory/linear_transport_eqs/#upwind-scheme","title":"Upwind scheme","text":"<p>To respect the flow of information, we can use forward and backward differences in space depending on the direction of propagation of information, i.e.</p> \\[     \\frac{U_j^{n+1} - U_j^n}{\\Delta t}     + \\frac{a^+ (U_j^n - U_{j-1}^n)}{\\Delta x} + \\frac{a^- (U_{j+1}^n - U_j^n)}{\\Delta x} = 0. \\] <p>Information is \"carried by the wind\", hence the name upwind. The above equations can be written as</p> \\[     \\frac{U_j^{n+1} - U_j^n}{\\Delta t} + \\frac{a (U_{j+1}^n - U_{j-1}^n)}{2 \\Delta x}     = \\frac{\\abs{a}}{2\\Delta x} (U_{j+1}^n - 2 U_j^n + U_{j-1}^n). \\] <p>We see we have the central difference scheme with a diffusion term; the right hand side approximates \\(\\frac{\\Delta x \\abs{a}}{2} U_xx\\). Thus, it adds numerical viscosity to the unstable central difference scheme, which will play a crucial role later.</p> <p>Now, we do the same numerical experiment as previously with \\(a = 1\\):</p> <pre><code>x_L, x_R = 0, 1\nT = 1\nN = 50\ndx = (x_R - x_L)/N\ndt = 1.3 * dx\nx = x_L + dx:dx:x_R\nt = dt:dt:T\n\na(x, t) = 1\n\nU = upwind.upwind_scheme(x, t, a, u0)\n\n\nViz.animate_solution(U,\n                    (x, t) -&gt; u0(x-t),\n                    x, t)\n</code></pre> <p></p> <pre><code>x_L, x_R = 0, 1\nT = 1\nN = 100\ndx = (x_R - x_L)/N\ndt = 0.7 * dx\nx = x_L+dx:dx:x_R\nt = dt:dt:T\n\na(x, t) = 1\n\nU = upwind.upwind_scheme(x, t, a, u0)\n\nViz.animate_solution(U,\n                     (x, t) -&gt; u0(x-t),\n                     x, t)\n</code></pre> <p></p> <p>We see that stability depends on the relation \\(\\frac{\\Delta t}{\\Delta x}\\). </p> <p>Lemma</p> <p>If the mesh parameters satisfy the condition</p> \\[\\frac{\\abs{a} \\Delta t}{\\Delta x} \\leq 1,\\] <p>then the upwind solution satisfies the estimate</p> \\[E^{n+1} \\leq E^n\\] <p>so the scheme is conditionally stable.</p> Proof <p>Start similarly to the proof of the unconditional unstability of the central difference scheme and use the mentioned identity several times.</p> <p>The above condition is called A CFL condition. We also have \\(L^1\\) and \\(L^\\infty\\) stability:</p> <p>Lemma</p> <p>Assume the above CFL condition holds. Then, the solutions of the upwind scheme satisfy</p> \\[     \\norm{U^{n+1}}_{L^1} \\le \\norm{U^n}_{L^1}, \\quad     \\norm{U^{n+1}}_{L^\\infty} \\le \\norm{U^n}_{L^\\infty}. \\] Proof <p>The first inequality follows from \\(U_j^{n+1}\\)being a convex combination of \\(U_{j-1}^n\\), \\(U_j^n\\) and \\(U_{j+1}^n\\).</p> <p></p> <p></p>"},{"location":"theory/linear_transport_eqs/#discontinuous-initial-data","title":"Discontinuous initial data","text":"<p>We now consider the transport equation with \\(a = 1\\) in the domain \\([0, 1]\\) with initial data</p> \\[     U_0(x) = \\begin{cases}         2, &amp; x &lt; 0.5, \\\\         1, &amp; x \\geq 0.5.     \\end{cases} \\] <pre><code>u0(x) = x .&lt; 0.5 ? 2 : 1\na(x, t) = 1\n</code></pre> <p>This yields the discontinuous solution \\(U(x, t) = U_0(x - t)\\). We use the upwind scheme with \\(N = 50\\) and \\(N = 200\\) mesh points.</p> <pre><code>x_L, x_R = 0, 1\nT = 0.25\nN = 50\n\ndx = (x_R - x_L)/N\ndt = 0.9 * dx\nx = x_L+dx:dx:x_R\nt = dt:dt:T\n\nU = upwind.upwind_scheme(x, t, a, u0)\n\nViz.animate_solution(U,\n                     (x, t) -&gt; u0(x-t),\n                     x, t)\n</code></pre> <p></p> <pre><code>x_L, x_R = 0, 1\nT = 0.25\nN = 200\ndx = (x_R - x_L)/N\ndt = 0.9 * dx\n\nx = x_L+dx:dx:x_R\nt = dt:dt:T\n\nU = upwind.upwind_scheme(x, t, a, u0)\n\nViz.animate_solution(U,\n                     (x, t) -&gt; u0(x-t),\n                     x, t)\n</code></pre> <p></p>"},{"location":"theory/scalar_cons_laws/","title":"Scalar conservation laws","text":"<p>In the previous chapter, we considered the scalar conservation law</p> \\[ U_t + a(x,t) U_x = 0 \\] <p>This was linear, as \\(a\\) was a given function. However, the velocity field can depend on the solution, and the equation becomes nonlinear. For example, we can have</p> \\[ a(x, t) = U(x, t) \\] <p>and we get the inviscid Burgers' equation, which can be written on the conservative form</p> \\[ \\begin{equation}     U_t + \\qty(\\frac{1}{2} U^2)_x = 0 \\label{eq:burgers} \\end{equation} \\] <p>whenever \\(U\\) is smooth. More generally, we may have</p> \\[ \\begin{equation}     U_t + f(U)_x = 0 \\label{eq:scalar_cons_law} \\end{equation} \\] <p>where \\(f\\) is a given flux function. This is a nonlinear scalar conservation law.</p>"},{"location":"theory/scalar_cons_laws/#charachteristics-for-burgers-equation","title":"Charachteristics for Burgers' equation","text":"<p>The characteristics for the Burgers' equation are given by</p> \\[ \\begin{aligned}     x'(t) &amp;= U(x(t), t) \\\\     x(0) &amp;= x_0 \\end{aligned} \\] <p>We consider first the initial data</p> \\[ U_0(x) = \\begin{cases}     U_L, &amp; x &lt; 0 \\\\     U_R, &amp; x &gt; 0 \\end{cases} \\] <p>The soluiton is constant along the charachteristics, so</p> \\[ x(t) = U_0(x_0) t + x_0. \\] <p>Consider \\(U_L = 1\\) and \\(U_R = 0\\). Then, we clearly see that the characteristics will intersect. Thus, we get a discontinuity in the solution. This can also happen for smooth initial data.</p>"},{"location":"theory/scalar_cons_laws/#weak-solutions","title":"Weak solutions","text":"<p>We therefore need to use the weak formulation</p> \\[ \\begin{equation}     \\int_{\\R_+} \\int_\\R U \\phi_t + f(U) \\phi_x \\dd x \\dd t + \\int_\\R U_0(x) \\phi(x, 0) \\dd x = 0 \\label{eq:weak_scalar_cons_law} \\end{equation} \\] <p>for any test function \\(\\phi \\in C_c^1(\\R \\times \\R_+)\\).</p>"},{"location":"theory/scalar_cons_laws/#the-rankine-hugoniot-condition","title":"The Rankine-Hugoniot condition","text":"<p>In nature, the discontinuities appear as shock waves. These must saisfy some conditions. Assume that we have a weak solution \\(U\\) that is smooth on two regions \\(\\Omega^-, \\Omega^+\\) separated by a shock wave. Let the shock wave be defined by the curve \\(x = \\gamma(t)\\). Lastly, assume that \\(U \\in C^1(\\Omega^-) \\cap C^1(\\Omega^+)\\). Then, we have</p> \\[ \\begin{aligned}     \\int_\\Omega U \\phi_t + f(U) \\phi_x \\dd \\Omega     =&amp; -\\int_{\\Omega^+} (U_t + f(U)_x) \\phi \\dd \\Omega     + \\int_{\\partial \\Omega^+} \\bm F(U^+) \\cdot \\bm \\nu \\phi \\dd \\Omega \\\\     &amp;- \\int_{\\Omega^-} (U_t + f(U)_x) \\phi \\dd \\Omega     + \\int_{\\partial \\Omega^-} \\bm F(U^-) \\cdot \\bm \\nu \\phi \\dd \\Omega \\\\     =&amp; 0 \\end{aligned} \\] <p>where \\(\\bm F(U) = (U, f(U))\\). Up to normalizaton, we have that \\(\\bm \\nu = (1, -s(t))\\). Where \\(s(t) = \\gamma'(t)\\) is the speed of the shock curve. Then we have</p> \\[ \\int_{\\Omega^+\\cup\\Omega^-} \\underbrace{\\qty(U_t + f(U)_x)}_0 \\phi \\dd \\Omega + \\int_{\\gamma} \\qty(s(t)\\qty(U^+ - U^-) - \\qty(f(U^+) - f(U^-))) \\phi \\dd \\Omega = 0 \\] <p>This needs to hold for all test functions and \\(U^+, U^-\\) are smooth on \\(\\gamma\\), so we get the Rankine-Hugoniot condition</p> \\[ \\begin{equation}     s(t) \\qty(U^+ - U^-) = f(U^+) - f(U^-) \\label{eq:rankine_hugoniot} \\end{equation} \\] <p>where \\(U^\\pm\\) are evaluated on \\((\\gamma(t),t)\\).</p> <p>Theorem</p> <p>Let \\(\\gamma \\in C^1(\\R_+)\\) and \\(U \\in L^\\infty(\\R \\times \\R_+)\\) be of the form</p> \\[ U(x, t) = \\begin{cases}     U^+(x,t), &amp; x &lt; \\gamma(t) \\\\     U^-(x,t), &amp; x &gt; \\gamma(t) \\end{cases} \\] <p>where \\(U^\\pm \\in C^1(\\R \\times \\R_+)\\). Then, \\(U\\) solves \\((\\ref{eq:scalar_cons_law})\\) weakly if and only if</p> <ul> <li>\\(U^\\pm\\) solves it in the classical sense, and</li> <li>the shock speed \\(s(t)\\) satisfies the Rankine-Hugoniot condition \\((\\ref{eq:rankine_hugoniot})\\) at \\(x = \\gamma(t)\\).</li> </ul>"},{"location":"theory/scalar_cons_laws/#lax-entropy-condition","title":"Lax entropy condition","text":"<p>We consider again the Burgers' equation \\((\\ref{eq:burgers})\\) on the Riemann problem with \\(U_L = 1\\) and \\(U_R = 0\\). The yields the shock speed</p> \\[     s(t) = \\frac{\\frac{U_R^2}{2} - \\frac{U_L^2}{2}}{U_R - U_L} \\equiv \\frac{1}{2} \\] <p>The shock starts at \\(x = 0\\), so we get the weak solution</p> \\[ \\begin{equation}     U(x, t) = \\begin{cases}         1, &amp; x &lt; \\frac{1}{2} t \\\\         0, &amp; x &gt; \\frac{1}{2} t.     \\end{cases} \\label{eq:riemann_solution_1} \\end{equation} \\] <p>This satisfies \\((\\ref{eq:weak_scalar_cons_law})\\) and we see that the characteristsics flow into the shock. </p> <p>Next, consider the Riemann problem with \\(U_L = 0\\) and \\(U_R = 1\\). Then, the characteristics do not fill the plane. However, we see that </p> \\[ \\begin{equation}     U(x, t) = \\begin{cases}         0, &amp; x &lt; \\frac{1}{2} t \\\\         1, &amp; x &gt; \\frac{1}{2} t     \\end{cases} \\label{eq:riemann_solution_2} \\end{equation} \\] <p>is a solution of the weak formulation \\((\\ref{eq:weak_scalar_cons_law})\\). However, one can easily construct another solution</p> \\[ \\begin{equation}     U(x, t) = \\begin{cases}         0, &amp; x &lt; \\frac{1}{3} t \\\\         \\frac{2}{3}, &amp; \\frac{1}{3} t &lt; x &lt; \\frac{5}{6} t \\\\         0, &amp; x &gt; \\frac{5}{6} t.     \\end{cases} \\label{eq:riemann_solution_3} \\end{equation} \\] <p>This nonuniqueness is implicit in the weak formulation, so we need to impose extra conditions. Observe that the charachteristics of \\((\\ref{eq:riemann_solution_1})\\) flow into the shock, while the characteristics of \\((\\ref{eq:riemann_solution_2})\\) and \\((\\ref{eq:riemann_solution_3})\\) flow out from the shock. Intuitively, information should always flow from the initial data. This is the case for \\((\\ref{eq:riemann_solution_1})\\), but not for the other two. For the Burgers' equation, this requirement can be expressed as</p> \\[ U^- &gt; s &gt; U^+. \\] <p>For convex \\(f\\), this can be generalized to the Lax entropy condition</p> \\[ \\begin{equation}     f'(U^-) \\leq s \\leq f'(U^+). \\end{equation} \\] <p>Exercise</p> <p>We know that</p> \\[ U(x, t) = \\begin{cases}     U_L, &amp; x &lt; s t \\\\     U_R, &amp; x &gt; s t \\end{cases} \\] <p>is a weak solution of the Riemann problem.</p> <p>Assume that \\(f\\) is strictly convex and that \\(U_L &gt; U_R\\). Show that \\(U\\) satisfies the Lax entropy condition.</p> <p>Similarly, show that if \\(U_L &lt; U_R\\), then \\(U\\) does not satisfy the Lax entropy condition.</p> <p>It turns out that in the last case, a continuous solution exists.</p>"},{"location":"theory/scalar_cons_laws/#rarefaction-waves","title":"Rarefaction waves","text":"<p>We will assume that \\(f\\) is strictly convex. Note that scaling \\((x, t) \\mapsto (\\lambda x, \\lambda t)\\) does not change the solution and that the initial data is invariant under this scaling. Thus, it is natural to assume that the solution only depends on the ratio \\(\\xi:=\\frac{x}{t}\\):</p> \\[ U(x, t) = V\\qty(\\frac{x}{t}). \\] <p>Substituting this into the conservation law \\(\\ref{eq:scalar_cons_law}\\), we get</p> \\[ (f'(V(\\xi)) - \\xi) V'(\\xi) = 0. \\] <p>As \\(f'\\) is strictly increasing, the inverse function \\(f'^{-1}\\) exists. Thus, we get the rarefaction wave</p> \\[ V'(x/t) = \\qty(f')^{-1}(x/t). \\] <p>Then we can construct a weak solution satisfying the Lax entropy condition by</p> \\[ U(x, t) = \\begin{cases}     U_L, &amp; x \\le f'(U_L) t \\\\     (f')^{-1}(x/t), &amp; f'(U_L) t &lt; x \\le f'(U_R) t \\\\     U_R, &amp; x &gt; f'(U_R) t. \\end{cases} \\]"},{"location":"theory/scalar_cons_laws/#entropy-solutions","title":"Entropy solutions","text":"<p>The entropy condition is a local condition at shocks, so it may be difficoult to apply it in proofs of global stability estimates. We will here derive an equivalent global condition.</p>"},{"location":"theory/scalar_cons_laws/#the-entropy-condition","title":"The entropy condition","text":"<p>We add a viscous term to the conservation law:</p> \\[ \\begin{equation}     U_t^\\eps + f(U^\\eps)_x = \\eps U_{xx}^\\eps \\label{eq:convection-diffusion} \\end{equation} \\] <p>and later let \\(\\eps \\to 0\\). We now have a parabolic convection-diffusion equation. These equations have \\(C^\\infty\\) solutions. Now, let \\(\\eta : \\R \\to \\R\\) be a strictly convex function and define</p> \\[ q(U) = \\int_0^U f'(v)\u00a0\\nu'(v) \\dd v. \\] <p>We call \\((\\eta, q)\\) an entropy pair and respectively the entropy function and the entropy flux. Note that \\(q' = f' \\nu'\\). Then, multiplying \\((\\ref{eq:convection-diffusion})\\) with \\(\\eta'(U^\\eps)\\), we get</p> \\[ \\eta(U^\\eps)_t + q(U^\\eps)_x = \\eps \\eta(U^\\eps)_{xx} - \\eps \\eta''(U^\\eps) (U^\\eps_x)^2. \\] <p>By the conevxity of \\(\\eta\\), the last term is nonnegative, so we have</p> \\[ \\eta(U^\\eps)_t + q(U^\\eps)_x \\leq \\eps \\eta(U^\\eps)_{xx}. \\] <p>Then, for the vanishing viscosity solution \\(\\displaystyle U = \\lim_{\\eps \\to 0} U^\\eps\\), we get the entropy condition</p> \\[ \\begin{equation}     \\eta(U)_t + q(U)_x \\leq 0. \\label{eq:entropy_condition} \\tag{EI} \\end{equation} \\] <p>Again, this must be interpreted in the sense of distributions:</p> \\[ \\int_{\\R_+} \\int_\\R \\eta(U) \\phi_t + q(U) \\phi_x \\dd x \\dd t + \\int_\\R \\eta(U_0(x)) \\phi(x, 0) \\dd x \\leq 0 \\] <p>Definition (Entropy solution)</p> <p>A function \\(U \\in L^\\infty(\\R \\times \\R_+)\\) is an entropy solution of \\((\\ref{eq:scalar_cons_law})\\) if both</p> <ul> <li>\\(U\\) is a weak solution of \\((\\ref{eq:scalar_cons_law})\\), and</li> <li>\\(U\\) satisfies the entropy condition \\((\\ref{eq:entropy_condition})\\) for all entropy pairs \\((\\eta, q)\\).</li> </ul>"},{"location":"theory/scalar_cons_laws/#kruzkov-entropy-condition","title":"Kruzkov Entropy Condition","text":"<p>Of special importance is the family of entropy pairs</p> \\[ \\begin{aligned}     \\eta(U; c) &amp;= \\abs{U - c} \\\\     q(U; c) &amp;= \\sign(U - c) [f(U) - f(c)]. \\end{aligned} \\] <p>for \\(c \\in \\R\\). \\(U\\)satisfies the Kruzkov entropy condition if</p> \\[ \\begin{equation}     \\abs{U - c}_t + \\sign(U - c) [f(U) - f(c)]_x \\leq 0 \\label{eq:kruzkov_entropy_condition} \\tag{KEC} \\end{equation} \\] <p>in the weak sence for all \\(c \\in \\R\\). This is important because of the following lemma:</p> <p>Lemma</p> <p>Let \\(U \\in L^\\infty(\\R \\times \\R_+)\\).</p> \\[ U \\text{ is an entropy solution of } (\\ref{eq:scalar_cons_law}) \\iff U \\text{ satisfies } (\\ref{eq:kruzkov_entropy_condition}) \\] <p>Proof</p> \\(\\implies\\)\\(\\impliedby\\) <p>Follows from the definition of entropy solutions.</p> Weak solutionEntropy condition <p>Let \\(a, b \\in \\R\\). such that \\(a \\le U \\le b\\) a.e. in \\(\\R \\times \\R_+\\). Then, selecting \\(c=a\\), we get by \\((\\ref{eq:kruzkov_entropy_condition})\\)</p> \\[ U_t + f(U)_x \\leq 0 \\quad \\text{a.e. in } \\R \\times \\R_+. \\] <p>Similarly, selecting \\(c=b\\), we get</p> \\[ U_t + f(U)_x \\geq 0 \\quad \\text{a.e. in } \\R \\times \\R_+. \\] <p>This yields</p> \\[ U_t + f(U)_x = 0 \\quad \\text{a.e. in } \\R \\times \\R_+. \\] <p>so \\(U\\) is a weak solution. </p> <p>Any convex combination can be approximated by linear combinations of \\(\\eta(U; a)\\). Thus, the entropy condition holds for all entropy pairs.</p> <p>Theorem</p> <p>Let \\(\\gamma \\in C^1(\\R_+)\\) be a curve and \\(s = \\gamma'\\) be its speed. Assume \\(U \\in L^\\infty(\\R \\times \\R_+)\\) is a weak solution of \\((\\ref{eq:scalar_cons_law})\\) of the form</p> \\[ U(x, t) = \\begin{cases}     U^-(x, t), &amp; x &lt; \\gamma(t) \\\\     U^+(x, t), &amp; x &gt; \\gamma(t) \\end{cases} \\] <p>where \\(U^\\pm \\in C^1\\). Then, the following are equivalent:</p> <ol> <li>\\(U\\) is an entropy solution.</li> <li> <p>At \\(x = \\gamma(t)\\), \\(U\\) satisfies</p> \\[\\jump{q(U)} - s\\jump{U} \\le 0\\] <p>for all entropy pairs \\((\\eta, q)\\).</p> </li> <li> <p>For all \\(v \\in (U^-, U^+)\\), we have</p> \\[\\frac{f(v) - f(U^-)}{v - U^-} \\le s \\le \\frac{f(v) - f(U^+)}{v - U^+}\\] <p>along \\(s\\).</p> </li> </ol>"}]}