
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../scalar_cons_laws/">
      
      
        <link rel="next" href="../2nd_order_schemes/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Finite volume schemes - Homemade Conslaws</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/palettes.css">
    
      <link rel="stylesheet" href="../../stylesheets/admonitions/theorem.css">
    
      <link rel="stylesheet" href="../../stylesheets/admonitions/lemma.css">
    
      <link rel="stylesheet" href="../../stylesheets/admonitions/definition.css">
    
      <link rel="stylesheet" href="../../stylesheets/admonitions/proof.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="conslaws-dark" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#finite-volume-schemes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Homemade Conslaws" class="md-header__button md-logo" aria-label="Homemade Conslaws" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Homemade Conslaws
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Finite volume schemes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="conslaws-dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="conslaws-light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Conservation Laws

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../linear_transport_eqs/" class="md-tabs__link">
          
  
  Theory

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Homemade Conslaws" class="md-nav__button md-logo" aria-label="Homemade Conslaws" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Homemade Conslaws
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conservation Laws
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_transport_eqs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear transport equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scalar_cons_laws/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scalar conservation laws
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Finite volume schemes
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Finite volume schemes
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#finite-volume-schemes_1" class="md-nav__link">
    <span class="md-ellipsis">
      Finite volume schemes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Finite volume schemes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-grid" class="md-nav__link">
    <span class="md-ellipsis">
      The grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cell-averages" class="md-nav__link">
    <span class="md-ellipsis">
      Cell averages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integral-form" class="md-nav__link">
    <span class="md-ellipsis">
      Integral form
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#godunov-method" class="md-nav__link">
    <span class="md-ellipsis">
      Godunov method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#godunov-flux" class="md-nav__link">
    <span class="md-ellipsis">
      Godunov flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numerical-example" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusanov-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Rusanov scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consistent-conservative-and-monotone-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Consistent, conservative and monotone schemes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Consistent, conservative and monotone schemes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conservative-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Conservative schemes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consistent-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Consistent schemes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monotone-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Monotone schemes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stability-properties-of-monotone-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Stability properties of monotone schemes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stability properties of monotone schemes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#l-bound" class="md-nav__link">
    <span class="md-ellipsis">
      L∞ bound
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entropy-inequalities-and-lp-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Entropy-inequalities and Lᵖ bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tv-bound" class="md-nav__link">
    <span class="md-ellipsis">
      TV bound
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-continuity" class="md-nav__link">
    <span class="md-ellipsis">
      Time continuity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-of-monotone-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence of monotone schemes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2nd_order_schemes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Second order schemes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#finite-volume-schemes_1" class="md-nav__link">
    <span class="md-ellipsis">
      Finite volume schemes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Finite volume schemes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-grid" class="md-nav__link">
    <span class="md-ellipsis">
      The grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cell-averages" class="md-nav__link">
    <span class="md-ellipsis">
      Cell averages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integral-form" class="md-nav__link">
    <span class="md-ellipsis">
      Integral form
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#godunov-method" class="md-nav__link">
    <span class="md-ellipsis">
      Godunov method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#godunov-flux" class="md-nav__link">
    <span class="md-ellipsis">
      Godunov flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numerical-example" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusanov-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Rusanov scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consistent-conservative-and-monotone-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Consistent, conservative and monotone schemes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Consistent, conservative and monotone schemes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conservative-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Conservative schemes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consistent-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Consistent schemes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monotone-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Monotone schemes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stability-properties-of-monotone-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Stability properties of monotone schemes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stability properties of monotone schemes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#l-bound" class="md-nav__link">
    <span class="md-ellipsis">
      L∞ bound
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entropy-inequalities-and-lp-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Entropy-inequalities and Lᵖ bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tv-bound" class="md-nav__link">
    <span class="md-ellipsis">
      TV bound
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-continuity" class="md-nav__link">
    <span class="md-ellipsis">
      Time continuity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-of-monotone-schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence of monotone schemes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="finite-volume-schemes">Finite volume schemes</h1>
<p>We will now design efficient schemes for the conservation law</p>
<div class="arithmatex">\[
\begin{equation}
    U_t + f(U)_x = 0 \label{eq:conservation_law}
\end{equation}
\]</div>
<p>We have already seen that finite difference schemes works poorly, even for linear transport:</p>
<ul>
<li>In this case, we had to "upwind" wind scheme, taking the derivative in the direction of  information propagation. This is not possible a-priori for non-linear equations like <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span>.</li>
<li>It further requires smoothness and that <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> is satisfied pointwise. However, we are looking for entropy solutions, which may be discontinuous.</li>
</ul>
<h2 id="finite-volume-schemes_1">Finite volume schemes</h2>
<h3 id="the-grid">The grid</h3>
<p>For simplicity, we use uniform discretization of <span class="arithmatex">\([x_L, x_R]\)</span>:</p>
<ul>
<li>
<p>points:</p>
<div class="arithmatex">\[
\begin{aligned}
    x_j &amp;= x_L + \qty(j+\frac{1}{2})\Delta x \\
    \Delta x &amp;= \frac{x_R - x_L}{N+1}
\end{aligned}
\]</div>
<p>for <span class="arithmatex">\(j=0,\dots, N\)</span></p>
</li>
<li>
<p>midpoints:</p>
<div class="arithmatex">\[x_{j-\frac{1}{2}} = x_j - \frac{1}{2}\Delta x = x_L + j\Delta x\]</div>
<p>for <span class="arithmatex">\(j=0,\dots, N+1\)</span></p>
</li>
<li>
<p>control volumes:</p>
<div class="arithmatex">\[\Cell_j = [x_{j-1/2}, x_{j+1/2}]\]</div>
<p>for <span class="arithmatex">\(j=1,\dots, N\)</span></p>
</li>
<li>
<p>uniform discretization of time:</p>
<div class="arithmatex">\[t^n = n\Delta t\]</div>
</li>
</ul>
<h3 id="cell-averages">Cell averages</h3>
<p>The finite difference schemes approximates the point values, whereas the finite volume schemes aims to approximate the cell averages</p>
<div class="arithmatex">\[U_j^n \approx \frac{1}{\Delta x}\int_{\Cell_j} U(x, t^n) \dd x\]</div>
<p>starting with</p>
<div class="arithmatex">\[U_j^0 = \frac{1}{\Delta x}\int_{\Cell_j} U_0(x) \dd x\]</div>
<h3 id="integral-form">Integral form</h3>
<p>Assuming <span class="arithmatex">\(U_j^n\)</span> is known for som time <span class="arithmatex">\(t^n\)</span>, we can integrate <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> over the swuare <span class="arithmatex">\(\Cell_j \times [t^n, t^{n+1})\)</span> to get the next averages:</p>
<div class="arithmatex">\[\int_{t^n}^{t^{n+1}} \int_{\Cell_j} U_t + f(U)_x \dd x \dd t = 0.\]</div>
<p>Defining the flux <span class="arithmatex">\(\overline F_{j+1/2}^n\)</span> across the boundary <span class="arithmatex">\(x_{j+1/2}\)</span> over the time interval <span class="arithmatex">\([t^n, t^{n+1})\)</span>:</p>
<div class="arithmatex">\[
\begin{equation}    
    \overline F_{j+1/2}^n = \frac{1}{\Delta t}\int_{t^n}^{t^{n+1}} f(U(x_{j+1/2}, t)) \dd t
    \label{eq:flux}
\end{equation}
\]</div>
<p>we can rewrite the above equation as</p>
<div class="arithmatex">\[
\begin{equation}
    U_j^{n+1} = U_j^n - \frac{\Delta t}{\Delta x}\qty(\overline F_{j+1/2}^n - \overline F_{j-1/2}^n).
    \label{eq:cell_average_update}
\end{equation}
\]</div>
<p>In other words, the change in cell averages is given by difference in fluxes across the cell boundaries. It now remains to approximate the fluxes.</p>
<h3 id="godunov-method">Godunov method</h3>
<p>Godunov noticed that the cell averages are constant in each cell <span class="arithmatex">\(\Cell_j\)</span> at each time. We thus get a Riemann problem at each cell interface <span class="arithmatex">\(x_{j+1/2}\)</span>:</p>
<div class="arithmatex">\[
\begin{equation}
    \left\{\begin{aligned}
        U_t + f(U)_x &amp; = 0 \\
        U(x, t^n) &amp; = \begin{cases}
            U_j^n, &amp; x &lt; x_{j+1/2} \\
            U_{j+1}^n, &amp; x &gt; x_{j+1/2}
        \end{cases}
    \end{aligned}\right. \label{eq:riemann_problem} \tag{RP}
\end{equation}
\]</div>
<p>So at each time, we get a superposition of Riemann problems of the form <span class="arithmatex">\(\eqref{eq:riemann_problem}\)</span>, at each interface. We have seen that the entropy solution is a combination of shocks, rarefactions and compound waves.</p>
<p>As previously discussed, the solution <span class="arithmatex">\(\overline U_j(x,t)\)</span> of each Riemann problem <span class="arithmatex">\(\eqref{eq:riemann_problem}\)</span> is self-similar:</p>
<div class="arithmatex">\[
\begin{equation}
    \overline U_j(x,t) = \overline U_j\qty(\frac{x-x_{j+1/2}}{t-t^n}) = \overline U_j(\xi). \label{eq:self_similar}
\end{equation}    
\]</div>
<p>However, the waves intersect after some time. The maximal speed of the waves is given by <span class="arithmatex">\(\displaystyle\max_j \abs{f'(U_j^n)}\)</span>. Thus, to ensure that two neighboring waves do not intersect, they cannot travel in total more that <span class="arithmatex">\(\Delta x\)</span> in time <span class="arithmatex">\(\Delta t\)</span>. This yields the CFL-condition</p>
<div class="arithmatex">\[
\begin{equation}
    \max_j \abs{f'(U_j^n)} \frac{\Delta t}{\Delta x} \leq \frac{1}{2} \label{eq:CFL_condition} \tag{CFL}
\end{equation}
\]</div>
<p>Assume that this condition is satisfied, and consider the curve given by <span class="arithmatex">\(\xi = 0\)</span>, i.e. the cell interface <span class="arithmatex">\(x_{j+1/2}\)</span>.</p>
<details class="claim">
<summary>Claim: <span class="arithmatex">\(f(\overline U_j(0))\)</span> is well defined</summary>
<p>By <span class="arithmatex">\(\eqref{eq:self_similar}\)</span>, we have that <span class="arithmatex">\(\overline U_j\)</span> is constant whenever <span class="arithmatex">\(\xi\)</span> is, and particularly at <span class="arithmatex">\(\xi = 0\)</span>:</p>
<div class="arithmatex">\[f(U(x_{j+1/2}, t)) = f(\overline U_j(0))\]</div>
<p>Along this curve, <span class="arithmatex">\(\overline U_j\)</span> is either continuous or not.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Continuous</label><label for="__tabbed_1_2">Discontinuous</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In this case, we obviously have that</p>
<div class="arithmatex">\[f(\overline U_j(0^-)) = f(\overline U_j(0^+)),\]</div>
</div>
<div class="tabbed-block">
<p>For <span class="arithmatex">\(\overline U_j\)</span> to be an entropy solution, the shock must satisfy the Rankine-Hugoniot condition</p>
<div class="arithmatex">\[
\begin{equation}
    \jump{f(U)} = s\jump{U}. \label{eq:rankine_hugoniot} \tag{RH}
\end{equation}
\]</div>
<p>with <span class="arithmatex">\(s=0\)</span>. We immidiately get that</p>
<div class="arithmatex">\[f(\overline U_j(0^-)) = f(\overline U_j(0^+))\]</div>
</div>
</div>
</div>
<p>so <span class="arithmatex">\(f(\overline U_j(0)) = f(\overline U_j(0^-)) = f(\overline U_j(0^+))\)</span> is well defined.</p>
</details>
<p>Now, we can define the (Riemann) edge-centered fluxes</p>
<p>$$
\begin{equation}
    F_{j+1/2}^n := f(\overline U_j(0)).
    \label{eq:edge_centered_flux}
\end{equation}</p>
<p>Since this is constant in time, we can insert into <span class="arithmatex">\(\eqref{eq:flux}\)</span> and explicitly calculate</p>
<div class="arithmatex">\[\overline F_{j+1/2}^n = F_{j+1/2}^n.\]</div>
<p>Then, substituting into <span class="arithmatex">\(\eqref{eq:cell_average_update}\)</span>, we get</p>
<div class="arithmatex">\[
\begin{equation}
    U_j^{n+1} = U_j^n - \frac{\Delta t}{\Delta x}\qty(F_{j+1/2}^n - F_{j-1/2}^n).
    \label{eq:godunov}
\end{equation}
\]</div>
<h3 id="godunov-flux">Godunov flux</h3>
<p>It can be shown that the Riemann fluxes at the interfaces <span class="arithmatex">\(x_{j+1/2}\)</span> is</p>
<div class="arithmatex">\[
\begin{equation}
    F_{j+1/2}^n = F(U_j^n, U_{j+1}^n)
    = \begin{cases}
        \displaystyle
        \min_{U_j^n \leq \theta \leq U_{j+1}^n} f(\theta), &amp; U_j^n \leq U_{j+1}^n \\
        \displaystyle
        \max_{U_{j+1}^n \leq \theta \leq U_j^n} f(\theta), &amp; U_j^n &gt; U_{j+1}^n.
    \end{cases}
    \label{eq:godunov_flux}
\end{equation}
\]</div>
<p>This also holds for non-convex flux functions. Further, for flux functions <span class="arithmatex">\(f\)</span> with a unique minimizer <span class="arithmatex">\(\omega\)</span>, we can simplify further to</p>
<div class="arithmatex">\[
\begin{equation}
    F_{j+1/2}^n = F(U_j^n, U_{j+1}^n) = \max\qty{f\qty(\max\{U_j^n, \omega\}), f\qty(\min\{U_{j+1}^n, \omega\})}.
    \label{eq:godunov_flux_simplified}
\end{equation}
\]</div>
<h3 id="numerical-example">Numerical example</h3>
<p>Now, using <span class="arithmatex">\(\eqref{eq:godunov_flux_simplified}\)</span>, one can easily implement the Godunov method. Testing against Burgers' equation with initial conditions</p>
<div class="arithmatex">\[
\begin{equation}
    U_0(x) = \begin{cases}
        1, &amp; x &lt; 0 \\
        0, &amp; x \geq 0
    \end{cases} \label{eq:initial_condition_shock}
\end{equation}
\]</div>
<p>we know the solution is a shock wave at <span class="arithmatex">\(x = 1/2t\)</span>.</p>
<p>```@example 1
x_L, x_R = -1, 1
f(U) = U^2/2+1
df(U) = U
ω = 0
N = 50
dx = (x_R - x_L) / (N + 1)
x_mid = x_L + 0:dx:x_R
U0 = x_mid .&lt; 0
BC(t, U) = [1;; 0]
dt = 0.1 # max time step
T = 1
U, t = godunov_scheme(f, df, ω, U0, BC, dx, dt, T)</p>
<p>animate_solution((U,),
                 "Approximate solution",
                 x_mid, t)
<div class="highlight"><pre><span></span><code>The numerical solution approxumates this well, having a sharp shock at $x = 1/2t$. Further, it seems stable without any oscillations. Next, for the initial condition


$$
\begin{equation}
    U_0(x) = \begin{cases}
        -1, &amp; x &lt; 0 \\
        1, &amp; x \geq 0
    \end{cases} \label{eq:initial_condition_rarefaction}
\end{equation}
$$


we expect a rarefaction wave between the curves $x = -t$ and $x = t$:


```@example 1
U0 = (x_mid .&gt; 0) * 2 .-1
BC(t, U) = [-1;; 1]
U, t = godunov_scheme(f, df, ω, U0, BC, dx, dt, T)

animate_solution((U,),
                 &quot;Approximate solution&quot;,
                 x_mid, t)
</code></pre></div></p>
<p>For a more complicated example, <span class="arithmatex">\(U_0 = \sin(4\pi x)\)</span>, we expect a compound wave:</p>
<p>```@example 1
U0 = sin.(4π*x_mid)
BC(t, U) = [0;; 0]
U, t = godunov_scheme(f, df, ω, U0, BC, dx, dt, T)</p>
<p>animate_solution((U,),
                 "Approximate solution",
                 x_mid, t)
<div class="highlight"><pre><span></span><code>### Limitations

Despite having many disirable properties, the Godunov method has some limitations:

- It requires having an explicit formula for the solutions of the Riemann problems $\eqref{eq:riemann_problem}$. This is not always the case for systems of conservation laws.
- In the numerical flux $\eqref{eq:edge_centered_flux}$, the only required information is the flux at the interface. It may thus be unnecessary to solve an entire Riemann problem for this.
- For more complicated flux functions with multiple extremas, one cannot use $\eqref{eq:godunov_flux_simplified}$. Instead, one must solve the optimization problem $\eqref{eq:godunov_flux}$, which may be computationally expensive.


## Approximate Riemann solvers

Instead of solving $\eqref{eq:riemann_problem}$ exactly, one can approximate them. These solutions can be used to define the numerical flux $F$. Such schems are called *approximate Riemann solvers*.

### Linearized (Roe) solvers

One simple method is to linearize the conservation law $\eqref{eq:conservation_law}$:

$$f(U)_x = f&#39;(U)U_x \approx \hat A_{j+1/2} U_x.$$

For example, one may use the *Roe average*

$$\hat A_{j+1/2} = \begin{cases}
    \frac{f(U_{j+1}^n) - f(U_j^n)}{U_{j+1}^n - U_j^n}, &amp; U_{j+1}^n \neq U_j^n \\
    f&#39;(U_j^n), &amp; U_{j+1}^n = U_j^n.
\end{cases}$$

Now, we can obtain the numerical flux $F$ by replacing $\eqref{eq:riemann_problem}$ with the linearized problem

$$
\begin{equation}
    \left\{\begin{aligned}
        U_t + \hat A_{j+1/2} U_x &amp; = 0 \\
        U(x, t^n) &amp; = \begin{cases}
            U_j^n, &amp; x &lt; x_{j+1/2} \\
            U_{j+1}^n, &amp; x &gt; x_{j+1/2}
        \end{cases}
    \end{aligned}\right. \label{eq:linearized_riemann_problem} \tag{LRP}
\end{equation}
$$

Notice that this is just the linear transport equation with the explicit solution

$$
\begin{equation}
    F_{j+1/2}^n = F^\text{Roe}(U_j^n, U_{j+1}^n) = \begin{cases}
        f(U_j^n), &amp; \hat A_{j+1/2} \ge 0 \\
        f(U_{j+1}^n), &amp; \hat A_{j+1/2} &lt; 0.
    \end{cases}
    \label{eq:roe_flux}
\end{equation}
$$

The numerical scheme $\eqref{eq:cell_average_update}$ with this flux is called the *Roe* or *Murman-Roe* scheme. This preserves shocks well, but fails at rarefaction waves, for example our usual test case with initial data $\eqref{eq:initial_condition_rarefaction}$.

### Central schemes

Due to the linearization, we only get a single wave travelling in a single direction depending on the sign of the Roe average $\hat A$. This is also the case for shocks for the exact solution, but not for rarefaction waves. Therefore, the Roe scheme fails for rarefaction waves. Hence, instead of linearizing the conservation law, one can approximate the solution of the Riemann problem with two waves travelling in opposite directions from the interface with speeds $s_{j+1/2}^l$ and $s_{j+1/2}^r$. Different such speeds yields different schemes. The approximate solution is then

$$
U(x, t) = \begin{cases}
    U_j^n, &amp; x &lt; s_{j+1/2}^l t \\
    U_{j+1}^*n, &amp; s_{j+1/2}^l t &lt; x &lt; s_{j+1/2}^r t \\
    U_{j+1}^n, &amp; x &gt; s_{j+1/2}^r t.
\end{cases}
$$

The middle state $U_{j+1/2}^*$ can be determined by using the Rankine Hugoniot condition:

$$
\begin{aligned}
    f(U_{j+1}^n) - f_{j+1/2}^* &amp;= s_{j+1/2}^r(U_{j+1}^n - U_{j+1/2}^*) \\
    f_{j+1/2}^* - f(U_j^n) &amp;= s_{j+1/2}^l(U_{j+1/2}^* - U_j^n),
\end{aligned}
$$

where $f_{j+1/2}^*$ is the middle flux. Now, solving for $f_{j+1/2}^*$, we get

$$f_{j+1/2}^* = \frac{s_{j+1/2}^r f(U_j^n) - s_{j+1/2}^l f(U_{j+1}^n) + s_{j+1/2}^r s_{j+1/2}^l(U_{j+1}^n - U_j^n)}{s_{j+1/2}^r - s_{j+1/2}^l}.$$

This yields the numerical flux

$$F_{j+1/2}^n = F(U_j^n, U_{j+1}^n) = f_{j+1/2}^*.$$

### Lax-Friedrichs scheme

By using the maximum speed the waves can travel without intersecting at the interface,

$$s_{j+1/2}^l = -\frac{\Delta x}{\Delta t}, \quad s_{j+1/2}^r = \frac{\Delta x}{\Delta t},$$

we get the Lax-Friedrichs flux

$$F_{j+1/2}^n = F^\text{LxF}(U_j^n, U_{j+1}^n) = \frac{f(U_j^n) + f(U_{j+1}^n)}{2} - \frac{\Delta x}{2\Delta t}(U_{j+1}^n - U_j^n).$$

The solutions are stable and non-oscillatory. Unlike the Roe scheme, it also approximates the entropy solution. However, shocks are not well preserved. See for example the usual Burgers&#39; test case with initial data $\eqref{eq:initial_condition_shock}$:


```@example 1
U0 = x_mid .&lt; 0     # hide
BC(t, U) = [1;; 0]  # hide
dt = 0.1 # max time step    # hide
T = 1   # hide
U, t = lax_friedrichs_scheme(f, df, U0, BC, dx, dt, T)    # hide

animate_solution(U, (x, t) -&gt; x &lt; 0.5t, x_mid, t) #hide
</code></pre></div></p>
<h3 id="rusanov-scheme">Rusanov scheme</h3>
<p>If we instead of using the maximum speeds use the speeds of propagation, we get the Rusanov scheme:</p>
<div class="arithmatex">\[s_{j+1/2}^l = -s_{j+1/2}, \quad s_{j+1/2}^r = s_{j+1/2}\]</div>
<p>with</p>
<div class="arithmatex">\[s_{j+1/2} = \max\qty{\abs{f'(U_j^n)}, \abs{f'(U_{j+1}^n)}}.\]</div>
<p>Then, we get the Rusanov (or Local Lax-Friedrichs) flux</p>
<div class="arithmatex">\[
\begin{aligned}
    F_{j+1/2}^n
    &amp;= F^\text{Rus}(U_j^n, U_{j+1}^n) \\
    &amp;= \frac{f(U_j^n) + f(U_{j+1}^n)}{2}
    - \frac{\max\qty{\abs{f'(U_j^n)}, \abs{f'(U_{j+1}^n)}}}{2}(U_{j+1}^n - U_j^n).
\end{aligned}
\]</div>
<p>For the same problem as above with get</p>
<p>```@example 1
U, t = rusanov_scheme(f, df, U0, BC, dx, dt, T)    # hide</p>
<p>animate_solution(U, (x, t) -&gt; x &lt; 0.5t, x_mid, t) #hide
<div class="highlight"><pre><span></span><code>and with the initial data $\eqref{eq:initial_condition_rarefaction}$, we get


```@example 1
U0 = (x_mid .&gt; 0) * 2 .-1 # hide
BC(t, U) = [-1;; 1] # hide
U, t = rusanov_scheme(f, df, U0, BC, dx, dt, T) # hide

animate_solution((U,), &quot;Approximation&quot;, x_mid, t) # hide
</code></pre></div></p>
<p><a id='Comparison'></a></p>
<p><a id='Comparison-1'></a></p>
<h3 id="comparison">Comparison</h3>
<p>```@example 1
U0 = x_mid .&lt; 0     # hide
BC(t, U) = [1;; 0] # hide</p>
<p>U_Rus, t = rusanov_scheme(f, df, U0, BC, dx, dt, T) # hide
U_LxF, _ = lax_friedrichs_scheme(f, df, U0, BC, dx, dt, T) # hide
U_God, _ = godunov_scheme(f, df, ω, U0, BC, dx, dt, T) # hide</p>
<p>animate_solution((U_Rus, U_LxF, U_God, x_mid' .&lt; 0.5t), # hide
                 ["Rusanov" "Lax-Friedrichs" "Godunov" "Exact"], # hide
                 x_mid, t) # hide
```</p>
<h2 id="consistent-conservative-and-monotone-schemes">Consistent, conservative and monotone schemes</h2>
<h3 id="conservative-schemes">Conservative schemes</h3>
<p>A numerical scheme approximating <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> can be formulated as</p>
<div class="arithmatex">\[
\begin{equation}
    U_j^{n+1} = H(U_{j-p}^n, \dots, U_{j+p}^n) \label{eq:general_scheme}
\end{equation}
\]</div>
<p>for some update function <span class="arithmatex">\(H\)</span> depending on the <span class="arithmatex">\(2p+1\)</span> points stencil <span class="arithmatex">\(\{U_{j-p}^n, \dots, U_{j+p}^n\}\)</span> for the scheme. Until now, we have worked with <span class="arithmatex">\(3\)</span>-stencil schemes, i.e. <span class="arithmatex">\(p=1\)</span>. </p>
<div class="admonition definition">
<p class="admonition-title">Definition (Conservative shceme)</p>
<p>The generic scheme <span class="arithmatex">\(\eqref{eq:general_scheme}\)</span> approximating <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> is called <em>conservative</em> if</p>
<div class="arithmatex">\[\sum_j U_j^{n+1} = \sum_j U_j^n,\]</div>
<p>ignoring the boundary conditions.</p>
</div>
<div class="admonition theorem">
<p class="admonition-title">Theorem</p>
<p>Assume <span class="arithmatex">\(H(0, \dots, 0) = 0\)</span>. </p>
<div class="arithmatex">\[
\begin{gather*}
    \eqref{eq:general_scheme} \text{ is conservative } \\
    \Updownarrow \\
    \text{There is a function } F_{j+1/2}^n = F(U_{j-p}^n, \dots, U_{j+p}^n) \text{ such that \eqref{eq:general_scheme} can be written as } \eqref{eq:cell_average_update}.
\end{gather*}
\]</div>
<details class="proof">
<summary>Proof</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1"><span class="arithmatex">\(\implies\)</span></label><label for="__tabbed_2_2"><span class="arithmatex">\(\impliedby\)</span></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Define</p>
<div class="arithmatex">\[G(U_{-p}, \dots, U_p) := \frac{\Dx}{\Dt}(U_0 - H(U_{-p}, \dots, U_p)).\]</div>
<p>By conservation, we have that</p>
<div class="arithmatex">\[\sum_j G(U_{j-p}^n, \dots, U_{j+p}^n) = \frac{\Dx}{\Dt}\sum_j (U_j^n - H(U_{j-p}^n, \dots, U_{j+p}^n)) = 0\]</div>
<p>for any sequence <span class="arithmatex">\(\{U_j^n\}_j\)</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1"><span class="arithmatex">\(F_{i+1/2}\)</span></label><label for="__tabbed_3_2"><span class="arithmatex">\(F_{i-1/2}\)</span></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Now, define the sequence</p>
<div class="arithmatex">\[V_j^n :=  \begin{cases}
    0, &amp; j -i \le -p \lor j-i &lt; p \\
    U_j^n, &amp; \text{otherwise}.
\end{cases}\]</div>
<p>Then, we have</p>
<div class="arithmatex">\[
\begin{aligned}
    0 &amp;= \sum_j G(V_{j-p}^n, \dots, V_{j+p}^n) \\
    &amp;= \underbrace{G(0, \dots, 0, U_{1-p-i}^n) + \dots + G(0, U_{1-p-i}^n, \dots, U_{p-i}^n)}_{F_{i+1/2}} \\
    &amp;\quad + \underbrace{G(U_{1-p-i}^n, \dots, U_{p-i}^n, 0) + \dots + G(U_{-p-i}^n, 0, \dots, 0)}_B
\end{aligned}
\]</div>
</div>
<div class="tabbed-block">
<p>Now, define the sequence</p>
<div class="arithmatex">\[W_j^n :=  \begin{cases}
    0, &amp; j -i &lt; -p \lor j-i &lt; p \\
    U_j^n, &amp; \text{otherwise}.
\end{cases}\]</div>
<p>Then, we have</p>
<div class="arithmatex">\[
\begin{aligned}
    0 &amp;= \sum_j G(W_{j-p}^n, \dots, W_{j+p}^n) \\
    &amp;= \underbrace{G(0, \dots, 0, U_{-p-i}^n) + \dots + G(0, U_{-p-i}^n, \dots, U_{p-i}^n)}_{F_{i-1/2}} \\
    &amp;\quad + G(U_{-p-i}^n, \dots, U_{p-i}^n) \\
    &amp;\quad + \underbrace{G(U_{1-p-i}^n, \dots, U_{p-i}^n, 0) + \dots + G(U_{-p-i}^n, 0, \dots, 0)}_B
\end{aligned}
\]</div>
</div>
</div>
</div>
<hr />
<p>This results in the form <span class="arithmatex">\(\eqref{eq:godunov}\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
    F_{i+1/2} + B &amp;= F_{i-1/2} + G(U_{-p-i}^n, \dots, U_{p-i}^n) + B \\
    F_{i+1/2} - F_{i-1/2} &amp;= \frac{\Dx}{\Dt}(U_i^n - H(U_{i-p}^n, \dots, U_{i+p}^n)) \\
    U_i^{n+1} &amp;= U_i^n - \frac{\Dt}{\Dx}(F_{i+1/2} - F_{i-1/2}).
\end{aligned}
\]</div>
</div>
<div class="tabbed-block">
<p>Then, we have</p>
<div class="arithmatex">\[U_j^{n+1} = H(U_{j-p}^n, \dots, U_{j+p}^n) = U_j^n - \frac{\Delta t}{\Delta x}\qty(F_{j+1/2}^n - F_{j-1/2}^n).\]</div>
<p>This yields a telescoping sum</p>
<div class="arithmatex">\[
\begin{aligned}
    \sum_j U_j^{n+1} &amp;= \sum_j \qty[U_j^n - \frac{\Delta t}{\Delta x}\qty(F_{j+1/2}^n - F_{j-1/2}^n)] \\
    &amp;= \sum_j U_j^n
\end{aligned}
\]</div>
</div>
</div>
</div>
</details>
</div>
<h3 id="consistent-schemes">Consistent schemes</h3>
<p>We now consider numerical fluxes <span class="arithmatex">\(F_{j+1/2}^n\)</span> defined on <span class="arithmatex">\(2p+1\)</span> stencils</p>
<div class="arithmatex">\[
\begin{equation}
    F_{j+1/2}^n = F(U_{j-p}^n, \dots, U_{j+p}^n) \label{eq:numerical_flux}
\end{equation}
\]</div>
<div class="admonition definition">
<p class="admonition-title">Definition (Consistency)</p>
<p>The numerical flux <span class="arithmatex">\(\eqref{eq:numerical_flux}\)</span> is <em>consistent</em> if <span class="arithmatex">\(F(U, \dots, U) = f(U)\)</span> for all <span class="arithmatex">\(U \in \R\)</span>.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>All the numerical fluxes disussed above are consistent. Take for example Lax-Friedrichs:</p>
<div class="arithmatex">\[F^\text{LxF}(U, U) = \frac{f(U) + f(U)}{2} - \frac{\Delta x}{2\Delta t}(U - U) = f(U).\]</div>
</div>
<p>However, conservation and consistency does not imply stability or convergence. Take for example the Roe flux <span class="arithmatex">\(\eqref{eq:roe_flux}\)</span>, which is trivially consistent but does not converge for certain problems.</p>
<h3 id="monotone-schemes">Monotone schemes</h3>
<p>Recall that entropy solutions to the conservation law <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> are monotinicity preserving. It would therefore be desirable to have numerical schemes that have a discrete version of this property.</p>
<div class="admonition definition">
<p class="admonition-title">Definition (Monotone scheme)</p>
<p>The numericals scheme <span class="arithmatex">\(\eqref{eq:general_scheme}\)</span> is <em>monotone</em> if it is non-decreasing in each argument, i.e. <span class="arithmatex">\((\nabla H)_i \ge 0\)</span> for all <span class="arithmatex">\(i\)</span>.</p>
</div>
<div class="admonition lemma">
<p class="admonition-title">Lemma</p>
<p>Let <span class="arithmatex">\(F\)</span> be a locally Lipschitz continuous two-point numerical flux. Then we have</p>
<div class="arithmatex">\[\eqref{eq:godunov} \text{ is monotone} \iff \begin{aligned}
    a &amp; \mapsto F(a, b) \text{ is non-decreasing for fixed } b \\
    b &amp; \mapsto F(a, b) \text{ is non-increasing for fixed } a.
\end{aligned}\]</div>
<p>and we get the following CFL type condition</p>
<div class="arithmatex">\[
\begin{equation}
    \abs{\pdv{F}{a}(v,w)} + \abs{\pdv{F}{b}(u,v)} \le \frac{\Delta x}{\Delta t} \quad \forall u, v, w. \label{eq:monotone_CFL}
\end{equation}
\]</div>
</div>
<p>One cannowuse monotoicity to differentiate between robust and possibly non-robust schemes. For example, the Roe scheme is not monotone.</p>
<h2 id="stability-properties-of-monotone-schemes">Stability properties of monotone schemes</h2>
<p>Recall that the entropy solutions of <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> have</p>
<ol>
<li><span class="arithmatex">\(L^\infty\)</span> bound</li>
<li><span class="arithmatex">\(L^p\)</span> bounds</li>
<li><span class="arithmatex">\(TV\)</span> bound</li>
</ol>
<p>and satisfy time constinuity. We will show that monotone schemes have these properties.</p>
<h3 id="l-bound">L<sup>∞</sup> bound</h3>
<div class="admonition lemma">
<p class="admonition-title">Lemma</p>
<p>Let <span class="arithmatex">\(U_j^n\)</span> be the approximate solution using a consistent, monotone scheme of the form <span class="arithmatex">\(\eqref{eq:general_scheme}\)</span>. Then we have</p>
<div class="arithmatex">\[\min\{U_{j-p}^n, \dots, U_{j+p}^n\} \le U_j^{n+1} \le \max\{U_{j-p}^n, \dots, U_{j+p}^n\},\]</div>
<p>and in particular</p>
<div class="arithmatex">\[\min_i U_j^0 \le U_j^n \le \max_i U_j^0 \quad \forall n,j\]</div>
<details class="proof">
<summary>Proof</summary>
<p>Let <span class="arithmatex">\(\overline U_j^n = \max\{U_{j-p}^n, \dots, U_{j+p}^n\}\)</span> be the maximum of the stencil. Now, as <span class="arithmatex">\(\eqref{eq:general_scheme}\)</span> is monotone, we have</p>
<div class="arithmatex">\[
\begin{aligned}
    U_j^{n+1} &amp;= H(U_{j-p}^n, \dots, U_{j+p}^n) \\
    &amp;\le H(\overline U_{j-p}^n, U_{j-p+1}^n, \dots, U_{j+p}^n) \\
    &amp;\vdots \\
    &amp;\le H(\overline U_{j-p}^n, \dots, \overline U_{j+p}^n) \\
    &amp;= \overline U_j^n.
\end{aligned}
\]</div>
<p>Similarly, we get the minimum principle.</p>
<p>Propagating this through time, we get the last claim too.</p>
</details>
</div>
<h3 id="entropy-inequalities-and-lp-bounds">Entropy-inequalities and Lᵖ bounds</h3>
<p>In the continuous case, we used the entropy inequality to obtain <span class="arithmatex">\(L^p\)</span> bounds. We will use discrete counterpart to the Kruzkov entropy inequality. The <em>Crandall-Majda numerical entropy flux</em> is given by</p>
<div class="arithmatex">\[Q_{j+1/2}^n = Q(U_j^n, U_{j+1}^n) = F(U_j^n \lor k, U_{j+1}^n \lor k) - F(U_j^n \land k, U_{j+1}^n \land k),\]</div>
<p>where <span class="arithmatex">\(a \lor b = \max\{a, b\}\)</span> and <span class="arithmatex">\(a \land b = \min\{a, b\}\)</span>. For consistent numerical fluxes, we see that this entropy flux is consistent with the Kruskov entropy flux:</p>
<div class="arithmatex">\[
\begin{aligned}
    Q(U, U) &amp;= f(U \lor k) - f(U \land k) \\
    &amp;= \sign(U - k)\qty[f(U) - f(k)] \\
    &amp;= q(U; k).
\end{aligned}
\]</div>
<div class="admonition lemma">
<p class="admonition-title">Lemma (Crandall-Majda [CM80])</p>
<p>Let <span class="arithmatex">\(U_j^n\)</span> be the approximate solution using a consistent, conservative, monotone scheme of the form <span class="arithmatex">\(\eqref{eq:general_scheme}\)</span>. Then we have the discrete entropy inequality</p>
<div class="arithmatex">\[
\begin{equation}
    \abs{U_j^{n+1} - k}  - \abs{U_j^n - k} + \frac{\Delta t}{\Delta x}\qty(Q_{j+1/2}^n - Q_{j-1/2}^n) \le 0 \quad \forall n,j. \label{eq:discrete_entropy_inequality}
\end{equation}
\]</div>
<p>Moreover, if <span class="arithmatex">\(U_0 \in L^1(\R)\)</span>, then</p>
<div class="arithmatex">\[\sum_j \abs{U_j^n} \Delta x \le \norm{U_0}_{L^1(\R)}.\]</div>
<details class="proof">
<summary>Proof</summary>
<p>The scheme is conservative, so we have</p>
<div class="arithmatex">\[
\begin{aligned}
    H(U_{j-p}^n \lor k, &amp;\dots, U_{j+p}^n \lor k) \\
    &amp; = U_j^n + \frac{\Delta t}{\Delta x}\qty(F(U_{j-p}^n \lor k, \dots, U_{j+p}^n \lor k) - F(U_{j-p}^n \land k, \dots, U_{j+p}^n \land k)). \\
\end{aligned}
\]</div>
<p>and similarly for the minimum. Taking their difference, we get</p>
<div class="arithmatex">\[
\begin{aligned}
    H(U_{j-p}^n \lor k, &amp;\dots, U_{j+p}^n \lor k)
    - H(U_{j-p}^n \land k, \dots, U_{j+p}^n \land k) \\
    &amp; = U_j^n \lor k - U_j^n \land k
    - \frac{\Delta t}{\Delta x}\qty(Q_{j+1/2}^n - Q_{j-1/2}^n) \\
    &amp;= \abs{U_j^{n+1} - k}  - \frac{\Delta t}{\Delta x}\qty(Q_{j+1/2}^n - Q_{j-1/2}^n)
\end{aligned}
\]</div>
<p>Further, by monotonicity, we have</p>
<div class="arithmatex">\[H(U_{j-p}^n \lor k, \dots, U_{j+p}^n \lor k) \ge \begin{matrix}
    U_j^{n+1} \\ k
\end{matrix}
\ge H(U_{j-p}^n \land k, \dots, U_{j+p}^n \land k),\]</div>
<p>so inserting into the above equation, we get the first claim.</p>
<p>Now, let <span class="arithmatex">\(k=0\)</span> and sum over <span class="arithmatex">\(j\)</span> to get the second claim.</p>
</details>
</div>
<h3 id="tv-bound">TV bound</h3>
<p>If we interpret the cell averages as step functions, then the total variation reduces to the sum of the jumps:</p>
<div class="arithmatex">\[\norm{U^n}_{TV(\R)} = \sum_j \abs{U_j^n - U_{j-1}^n}.\]</div>
<p>We can rewrite the finite volume scheme <span class="arithmatex">\(\eqref{eq:godunov}\)</span> in the incremental form</p>
<div class="arithmatex">\[
\begin{equation}
    U_j^{n+1} = U_j^n + C_{j+1/2} \qty(U_{j+1}^n - U_j^n) - D_{j-1/2} \qty(U_j^n - U_{j-1}^n)
    \label{eq:incremental_form}
\end{equation}
\]</div>
<p>where</p>
<div class="arithmatex">\[C_{j+1/2}^n = \frac{\Delta t}{\Delta x} \frac{f(U_j^n) - F_{j+1/2}^n}{U_{j+1}^n - U_j^n},
\quad D_{j+1/2}^n = \frac{\Delta t}{\Delta x} \frac{f(U_{j+1}^n) - F_{j+1/2}}{U_{j+1}^n - U_j^n}.\]</div>
<p>Then, wecanuse the following result:</p>
<div class="admonition lemma">
<p class="admonition-title">Hartem's Lemma [Har83]</p>
<p>Let <span class="arithmatex">\(U_j^n\)</span> be computed with <span class="arithmatex">\(\eqref{eq:incremental_form}\)</span>.</p>
<ol>
<li>
<p>If <span class="arithmatex">\(C_{j+1/2}^n, D_{j+1/2}^n \ge 0\)</span> and <span class="arithmatex">\(C_{j+1/2}^n + D_{j+1/2}^n \le 1\)</span> for all <span class="arithmatex">\(n, j\)</span>, then</p>
<div class="arithmatex">\[\norm{U^{n+1}}_{TV(\R)} \le \norm{U^n}_{TV(\R)}.\]</div>
</li>
<li>
<p>If <span class="arithmatex">\(C_{j+1/2}^n, D_{j-1/2}^n \ge 0\)</span> and <span class="arithmatex">\(C_{j+1/2}^n + D_{j-1/2}^n \le 1\)</span> for all <span class="arithmatex">\(n, j\)</span>, then</p>
<div class="arithmatex">\[\norm{U^{n+1}}_{L^\infty} \le \norm{U^n}_{L^\infty}.\]</div>
</li>
</ol>
<details class="proof">
<summary>Proof</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">1.</label><label for="__tabbed_4_2">2.</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Using <span class="arithmatex">\(\eqref{eq:incremental_form}\)</span>, we get the difference</p>
<div class="arithmatex">\[
\begin{aligned}
    U_{j+1}^{n+1} - U_j^{n+1}
    \le&amp; \qty(1-C_{j+1/2}^n - D_{j+1/2}^n)\qty(U_{j+1}^n - U_j^n) \\
    &amp;+ C_{j+3/2}^n \qty(U_{j+2}^n - U_{j+1}^n) \\
    &amp;+ D_{j-1/2}^n \qty(U_j^n - U_{j-1}^n).
\end{aligned}
\]</div>
<p>Taking the absolute value, we get the inequality</p>
<div class="arithmatex">\[
\begin{aligned}
    \abs{U_{j+1}^{n+1} - U_j^{n+1}}
    &amp;\le \qty(1-C_{j+1/2}^n - D_{j+1/2}^n)\abs{U_{j+1}^n - U_j^n} \\
    &amp;\quad + C_{j+3/2}^n \abs{U_{j+2}^n - U_{j+1}^n} \\
    &amp;\quad + D_{j-1/2}^n \abs{U_j^n - U_{j-1}^n}.
\end{aligned}
\]</div>
<p>Summing over <span class="arithmatex">\(j\)</span>, we get a telescoping sum, resulting in</p>
<div class="arithmatex">\[\sum_j \abs{U_{j+1}^{n+1} - U_j^{n+1}} \le \sum_j \abs{U_{j+1}^n - U_j^n}.\]</div>
</div>
<div class="tabbed-block">
<p>Rewriting <span class="arithmatex">\(\eqref{eq:incremental_form}\)</span> as</p>
<div class="arithmatex">\[U_j^{n+1} = C_{j+1/2}^n U_{j+1}^n
+ \qty(1 - C_{j+1/2}^n - D_{j-1/2}^n) U_j^n
+ D_{j-1/2}^n U_{j-1}^n,\]</div>
<p>we see that <span class="arithmatex">\(U_j^{n+1}\)</span> is a convex combination of <span class="arithmatex">\(U_{j-1}^n, U_j^n, U_{j+1}^n\)</span>. Thus, <span class="arithmatex">\(U_j^{n+1}\)</span> is bounded by the maximum and minimum of these values, so we get the claim.</p>
</div>
</div>
</div>
</details>
</div>
<p>It turns out that consistent, conservative, monotone schemes satisfies these criteria, so we can use this lemma to show that the schemes are TVD.</p>
<div class="admonition lemma">
<p class="admonition-title">Lemma</p>
<p>Monotone, consistent, conservative 3-point schemes are TVD under the CFL condition <span class="arithmatex">\(\eqref{eq:monotone_CFL}\)</span>.</p>
<details class="proof">
<summary>Proof</summary>
<p>The coefficients are positive:</p>
<div class="arithmatex">\[
\begin{align*}
    C_{j+1/2}^n &amp;= \frac{\Delta t}{\Delta x} \frac{f(U_j^n) - F_{j+1/2}^n}{U_{j+1}^n - U_j^n} \\
    &amp;= \frac{\Delta t}{\Delta x} \frac{F(U_j^n, U_j^n) - F_{j+1/2}^n}{U_{j+1}^n - U_j^n}
    \tag*{(Consistency)} \\
    &amp;\ge 0
    \tag*{(Monotonicity)}
\end{align*}
\]</div>
<p>Similarly for <span class="arithmatex">\(D_{j-1/2}^n\)</span>. Further, we have</p>
<div class="arithmatex">\[
\begin{align*}
    C_{j+1/2}^n &amp;= \frac{\Delta t}{\Delta x} \frac{F(U_j^n, U_j^n) - F_{j+1/2}^n}{U_{j+1}^n - U_j^n} \\
    &amp; \le \frac{\Delta t}{\Delta x} \norm{\pdv{F}{a}}_{L^\infty}
    \tag*{(Lipschitz flux)}
\end{align*}
\]</div>
<p>and similarly for <span class="arithmatex">\(D_{j-1/2}^n\)</span>. Then, under the CFL condition <span class="arithmatex">\(\eqref{eq:monotone_CFL}\)</span>, we get </p>
<div class="arithmatex">\[1 - C_{j+1/2}^n - D_{j-1/2}^n \ge 1 - \frac{\Delta x}{\Delta t} \qty(\abs{\pdv{F}{a}} + \abs{\pdv{F}{b}}) \ge 0.\]</div>
</details>
</div>
<h3 id="time-continuity">Time continuity</h3>
<p>In the continuous case, we have the time continuity property</p>
<div class="arithmatex">\[\norm{U(\cdot, t) - U(\cdot, s)}_{L^1(\R)} \le |t-s| \norm{f}_{\text{Lip}} \norm{U_0}_{TV(\R)}.\]</div>
<p>We can show that the discrete solution has a similar property.</p>
<div class="admonition lemma">
<p class="admonition-title">Lemma</p>
<p>Let <span class="arithmatex">\(U_j^n\)</span> computed using  consistent, conservative and monotone scheme with Lipschitz continuous numerical fluxe <span class="arithmatex">\(F=F(a,b)\)</span> whose Lipschitz constant is <span class="arithmatex">\(C_F\)</span>. Then we get</p>
<div class="arithmatex">\[\Delta x \sum_j \abs{U_j^n - U_j^m} \le 2C_F \abs{t^n - t^m} \norm{U_0}_{TV(\R)}.\]</div>
<details class="proof">
<summary>Proof</summary>
<p>Taking the absolute value of <span class="arithmatex">\(\eqref{eq:godunov}\)</span> and summing over <span class="arithmatex">\(j\)</span>, we get</p>
<div class="arithmatex">\[
\begin{aligned}
    \Delta x \sum_j \abs{U_j^{n+1} - U_j^n}
    &amp;= \Delta t \sum_j \abs{F_{j+1/2}^n - F_{j-1/2}^n} \\
    &amp;\le \Delta t \sum_j \abs{F(U_j^n, U_{j+1}^n) - F(U_j^n, U_j^n)} \\
    &amp; \quad + \Delta t \sum_j \abs{F(U_j^n, U_j^n) - F(U_{j-1}^n, U_j^n)} \\
    &amp; \le \Delta t \sum_j C_F \abs{U_{j+1}^n - U_j^n} + \Delta t \sum_j C_F \abs{U_j^n - U_{j-1}^n} \\
    &amp;= 2C_F \Delta t \sum_j \abs{U_{j+1}^n - U_j^n}.
\end{aligned}
\]</div>
<p>Now, taking the difference from <span class="arithmatex">\(k=n\)</span> to <span class="arithmatex">\(k=m\)</span> and using the TVD property, we get</p>
<div class="arithmatex">\[
\begin{aligned}
    \Delta x \sum_j \abs{U_j^n - U_j^m}
    &amp; \le \Delta x \sum_{k=n}^{m-1} \qty(\sum_j \abs{U_j^{k+1} - U_j^k}) \\
    &amp; \le 2C_F \Delta t \sum_{k=n}^{m-1} \norm{U^k}_{TV(\R)} \\
    &amp; \le 2C_F \abs{t^n - t^m} \norm{U_0}_{TV(\R)}.
\end{aligned}
\]</div>
</details>
</div>
<h2 id="convergence-of-monotone-schemes">Convergence of monotone schemes</h2>
<p>We have now shown that conserative, consistent and monotone schemes are stable in <span class="arithmatex">\(L^\infty\)</span> and <span class="arithmatex">\(TV\)</span>, are TVD and satisfy the discrete entropy inequality. We will use this to prove convergence. Further, Lax-Wendroff theorem shows that the limit is the entropy solution. To simplify notation, we will set</p>
<div class="arithmatex">\[
\newcommand{\UDx}{U^{\Delta x}}
\newcommand{\pDx}{\phi^{\Delta x}}
\UDx(x, t) = U_j^n \quad \text{for } (x, t) \in \Cell_j \times [t^n, t^{n+1}).
\]</div>
<div class="admonition theorem">
<p class="admonition-title">Lax-Wendroff theorem</p>
<p>Let <span class="arithmatex">\(U_j^n\)</span> an approxiamate solution of <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> using a consistent and conservative finite volume scheme. Assume that the numerical flux is differentiable and that <span class="arithmatex">\(U_j^0\)</span> are the cell averages of the initial data.</p>
<p>Assume further that</p>
<ul>
<li><span class="arithmatex">\(U_0 \in L^\infty(\R)\)</span>,</li>
<li><span class="arithmatex">\(\UDx\)</span> is uniformly bounded in <span class="arithmatex">\(\Delta x\)</span>,</li>
<li>there exists a function <span class="arithmatex">\(U \in L_{\text{loc}}^1(\R \times R_+)\)</span> such that <span class="arithmatex">\(\UDx \to U\)</span> in this space as <span class="arithmatex">\(\Delta x, \Delta t \to 0\)</span>.</li>
</ul>
<p>Then, <span class="arithmatex">\(U\)</span> is a weak solution of <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> with initial data <span class="arithmatex">\(U_0\)</span>.</p>
<details class="proof">
<summary>Proof</summary>
<p>Let <span class="arithmatex">\(\phi \in C_c^\infty(\R \times \R_+)\)</span>, be a test function. Next, sum <span class="arithmatex">\(\eqref{eq:godunov}\)</span> over <span class="arithmatex">\(j, n\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
    0 &amp;= \Dx \Dt \sum_j \sum_{n=0}^\infty
    \qty(\frac{U_j^{n+1} - U_j^n}{\Dt} + \frac{F_{j+1/2}^n - F_{j-1/2}^n}{\Dx}) \phi_j^n \\
    &amp;= - \Dx \sum_j U_j^0 \phi_j^0 - \Dx \sum_j \sum_{n=0}^\infty
    \qty(U_j^{n+1} \frac{\phi_j^{n+1} - \phi_j^n}{\Dt} + F_{j+1/2}^n \frac{\phi_{j+1}^n - \phi_j^n}{\Dx})
\end{aligned}
\]</div>
<p>As <span class="arithmatex">\(\phi\)</span> has compact support, the above sum is finite. Define <span class="arithmatex">\(\phi_j^n = \phi(x_j, t^n)\)</span> and denote <span class="arithmatex">\(\pDx(x, t)\)</span> similarly to <span class="arithmatex">\(\UDx\)</span>. Then, we can express the above sums as integrals:</p>
<div class="arithmatex">\[
\begin{aligned}
    0 &amp;= \underbrace{\int_\R \UDx(x, 0) \pDx(x, 0) \dd x
    + \int_\R \int_0^\infty \UDx(x, t + \Dt) \frac{\pDx(x, t + \Dt) - \pDx(x, t)}{\Dt} \dd t \dd x}_{I_1^{\Delta x}} \\
    &amp;\quad + \underbrace{\int_\R \int_0^\infty F\qty(\UDx(x, t), \UDx(x + \Dx, t)) \frac{\pDx(x + \Dx, t) - \pDx(x, t)}{\Dx} \dd t \dd x}_{I_2^{\Delta x}}.
\end{aligned}
\]</div>
<p>We have that <span class="arithmatex">\(\abs{\UDx} \le \abs{U}\)</span> and <span class="arithmatex">\(\abs{\pDx} \le \abs{\phi}\)</span>, so we can use the dominated convergence theorem for the first two integrals <span class="arithmatex">\(I_1^{\Delta x}\)</span> yielding</p>
<div class="arithmatex">\[I_1^{\Delta x} \xrightarrow{\Delta x, \Delta t \to 0} \int_\R U_0(x) \phi(x, 0) \dd x + \int_\R \int_0^\infty U \phi_t \dd t \dd x.\]</div>
<p>Next, rewrite <span class="arithmatex">\(I_2^{\Delta x}\)</span> as</p>
<div class="arithmatex">\[
\begin{aligned}
    I_2^{\Delta x} &amp;= \underbrace{\int_\R \int_0^\infty f(\UDx(x, t)) \frac{\pDx(x + \Dx, t) - \pDx(x, t)}{\Dx} \dd t \dd x}_{I_{2,1}^{\Delta x}} \\
    &amp; \quad\quad + \underbrace{\int_\R \int_0^\infty \qty[F\qty(\UDx(x, t), \UDx(x + \Dx, t)) - f(\UDx(x, t))]
    \frac{\pDx(x + \Dx, t) - \pDx(x, t)}{\Dx} \dd t \dd x}_{I_{2,2}^{\Delta x}}.
\end{aligned}
\]</div>
<details class="claim">
<summary>Claim: <span class="arithmatex">\(I_{2,2}^{\Delta x} \xrightarrow{\Delta x, \Delta t \to 0} 0\)</span></summary>
<p>Recall that <span class="arithmatex">\(F\)</span> is differentiable and <span class="arithmatex">\(U \in L^\infty(\R \times \R_+)\)</span>, so we have</p>
<div class="arithmatex">\[
\begin{aligned}
    &amp; \abs{F\qty(\UDx(x, t), \UDx(x + \Dx, t)) - f(\UDx(x, t))} \\
    &amp; \quad\quad = \abs{F(\UDx(x, t), \UDx(x + \Dx, t)) - F(\UDx(x, t), \UDx(x, t))} \\
    &amp; \quad\quad \le \tilde C \abs{\UDx(x + \Dx, t) - \UDx(x, t)}.
\end{aligned}
\]</div>
<p>we can use the above inequality for <span class="arithmatex">\(I_{2,2}^{\Delta x}\)</span> to get</p>
<div class="arithmatex">\[\abs{I_{2,2}^{\Delta x}} \le \tilde C \norm{\phi_x}_{L^\infty}
\iint_{\supp \phi_x} \abs{\UDx(x + \Dx, t) - \UDx(x, t)} \dd x \dd t\]</div>
<p>Using approximation by <span class="arithmatex">\(C^\infty\)</span> functions, we get thedesired result.</p>
<p>Let <span class="arithmatex">\(\psi_l \in C^\infty(\R)\)</span> be a sequence of functions converging to <span class="arithmatex">\(U\)</span> in <span class="arithmatex">\(L_{\text{loc}}^1(\R\times \R_+)\)</span>. The integrand can be bounded by</p>
<div class="arithmatex">\[
\begin{aligned}
    &amp; {\abs{\UDx(x + \Dx, t) - \psi_l(x,t)}}
    + \abs{\UDx(x, t) - \psi_l(x,t)} \\
    &amp; \quad \quad \le \underbrace{\abs{\UDx(x + \Dx, t) - U(x+\Dx, t)}}_{J_1}
    + \underbrace{\abs{U(x+\Dx, t) - \psi_l(x,t)}}_{J_2} \\
    &amp; \quad \quad \quad + \underbrace{\abs{\UDx(x, t) - U(x, t)}}_{J_3}
    + \underbrace{\abs{U(x, t) - \psi_l(x,t)}}_{J_4}.
\end{aligned}
\]</div>
<p>By dominated convergence, <span class="arithmatex">\(\iint_{\supp \phi_x} J_i \dd x \dd t \to 0\)</span> as <span class="arithmatex">\(\Delta x, \Delta t \to 0\)</span> for <span class="arithmatex">\(i=1,3\)</span>. By definition of <span class="arithmatex">\(\psi_l\)</span>, the same holds for <span class="arithmatex">\(i=4\)</span>. Convince yourself that it stays true for <span class="arithmatex">\(i=2\)</span>.</p>
</details>
<p>Again, by diminated convergence, we get that</p>
<div class="arithmatex">\[I_{2,1}^{\Delta x} \xrightarrow{\Delta x, \Delta t \to 0}
\int_\R \int_0^\infty f(U(x, t)) \phi_t \dd t \dd x.\]</div>
<p>Combining the results, we get</p>
<div class="arithmatex">\[0 = \int_\R U_0(x) \phi(x, 0) \dd x + \int_\R \int_0^\infty U \phi_t + f(U) \phi_t \dd t \dd x.\]</div>
</details>
</div>
<div class="admonition lemma">
<p class="admonition-title">Lemma</p>
<p>Assume the same conditions as in the Lax-Wendroff theorem, including that the discrete entropy inequality <span class="arithmatex">\(\eqref{eq:discrete_entropy_inequality}\)</span> holds. Then,</p>
<div class="arithmatex">\[U = \lim_{\Delta x, \Delta t \to 0} \UDx\]</div>
<p>is the entropy solution of <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span>.</p>
<details class="proof">
<summary>Proof</summary>
<p>The proof is almost identical to that of the Lax-Wendroff theorem. We start with the discrete entropy inequality <span class="arithmatex">\(\eqref{eq:discrete_entropy_inequality}\)</span> instead of <span class="arithmatex">\(\eqref{eq:godunov}\)</span> and use a non-negative test function <span class="arithmatex">\(\phi\)</span>. Then, following the same steps as in the proof of the Lax-Wendroff theorem, we get</p>
<div class="arithmatex">\[0 \ge I_1^{\Delta x} + I_2^{\Delta x}\]</div>
<p>where</p>
<div class="arithmatex">\[
\begin{aligned}
    I_1^{\Delta x} &amp;= \int_\R \abs{\UDx(x, 0) - k} \pDx(x, 0) \dd x \\
    &amp; \quad\quad+ \int_\R \int_0^\infty \abs{\UDx(x, t + \Dt) - k} \frac{\pDx(x, t + \Dt) - \pDx(x, t)}{\Dt} \dd t \dd x, \\
    I_2^{\Delta x} &amp;= \int_\R \int_0^\infty Q\qty(\UDx(x, t), \UDx(x + \Dx, t)) \frac{\pDx(x + \Dx, t) - \pDx(x, t)}{\Dx} \dd t \dd x.
\end{aligned}
\]</div>
<p>As with in the proof of the Lax-Wendroff theorem, we have that</p>
<div class="arithmatex">\[I_1^{\Delta x} \xrightarrow{\Delta x, \Delta t \to 0} \int_\R \abs{U_0(x)-k} \phi(x, 0) \dd x + \int_\R \int_0^\infty \abs{U-k} \phi_t \dd t \dd x.\]</div>
<p>We also rewrite <span class="arithmatex">\(I_2^{\Delta x} = I_{2,1}^{\Delta x} + I_{2,2}^{\Delta x}\)</span> as in Lax-Wendroff. Again,</p>
<div class="arithmatex">\[I_{2,1}^{\Delta x} \xrightarrow{\Delta x, \Delta t \to 0}
\int_\R \int_0^\infty q(U(x, t); k) \phi_t \dd t \dd x.\]</div>
<p>Doing as in the proof of the Lax-Wendroff theorem, we see that <span class="arithmatex">\(I_{2,2}^{\Delta x}\)</span> vanishes. Combining the results, we get</p>
<div class="arithmatex">\[0 \ge \int_\R \abs{U_0(x)-k} \phi(x, 0) \dd x + \int_\R \int_0^\infty \abs{U-k} \phi_t + q(U; k) \phi_t \dd t \dd x.\]</div>
</details>
</div>
<p>Now, we can use monotinicity, conservation, consistency and the following two known results to show convergence.</p>
<details class="theorem">
<summary>Ascoli's Theorem</summary>
<p>Let <span class="arithmatex">\((x, d_X)\)</span> be a metric space and <span class="arithmatex">\(K \subset X\)</span> be relatively compact. Further, let</p>
<div class="arithmatex">\[\qty{u_k : [0, T] \to K}_k\]</div>
<p>be a sequence of uniformly Lipschitz continuous functions, i.e.</p>
<div class="arithmatex">\[d_X(u_k(t), u_k(s)) \le C \abs{t-s} \quad \forall k\in \N, t, s \in [0, T].\]</div>
<p>Then, there exists a subsequence <span class="arithmatex">\(u_{k_\ell}\)</span> converging to a Lipschitz continuous function <span class="arithmatex">\(u\)</span> uniformly on <span class="arithmatex">\([0, T]\)</span>.</p>
</details>
<details class="theorem">
<summary>Helly's Theorem [Giu84, T.1.19]</summary>
<p>Let <span class="arithmatex">\(a, b \in \R\)</span> and <span class="arithmatex">\(K \subset L^1([a, b])\)</span>. If there exists a number <span class="arithmatex">\(M&gt;0\)</span> such that</p>
<div class="arithmatex">\[\sup_{U \in K} \|U\|_{BV([a, b])} \le M,\]</div>
<p>then <span class="arithmatex">\(K\)</span> is relatively compact in <span class="arithmatex">\(L^1([a, b])\)</span>.</p>
<hr />
<p>If additionally, <span class="arithmatex">\(K \subset L^1(\R)\)</span> and</p>
<div class="arithmatex">\[\lim_{R\to\infty} \sup_{U\in K} \int_{\R \setminus [-R, R]} \abs{U(x)} \dd x = 0,\]</div>
<p>then <span class="arithmatex">\(K\)</span> is relatively compact in <span class="arithmatex">\(L^1(\R)\)</span>.</p>
</details>
<p>For the convergence, we define the piecewise affine (in time) function</p>
<div class="arithmatex">\[\UDx(x, t) = \frac{t^{n+1} - t}{\Dt} U_j^n + \frac{t - t^n}{\Dt} U_j^{n+1}, \quad x \in \Cell_j, t \in [t^n, t^{n+1}).\]</div>
<div class="admonition theorem">
<p class="admonition-title">Theorem</p>
<p>Consider the conservation law <span class="arithmatex">\(\eqref{eq:conservation_law}\)</span> with <span class="arithmatex">\(f \in C^1(\R)\)</span> and <span class="arithmatex">\(U_0 \in BV(\R)\)</span>, and a conmsistent, conservative, monotone finite volumes scheme under the CFL condition <span class="arithmatex">\(\eqref{eq:monotone_CFL}\)</span>. Assume further that there is some <span class="arithmatex">\(c&gt;0\)</span> such that <span class="arithmatex">\(\frac{\Dt}{\Dx} \ge c\)</span>.</p>
<p>Then, <span class="arithmatex">\(\UDx \to U\)</span> in <span class="arithmatex">\(L^1(\R \times [0,T])\)</span> and <span class="arithmatex">\(U\)</span> is the entropy solution.</p>
<details class="proof">
<summary>Proof</summary>
<p>Let <span class="arithmatex">\(K = \qty{U = \UDx(\cdot, t) \mid t \in [0, T], \Dx &gt; 0}\)</span> be functions <span class="arithmatex">\(U : \R \to \R\)</span> attained at some time <span class="arithmatex">\(t\)</span> by the scheme.</p>
<details class="claim">
<summary>Claim: The conditions of Helly's Theorem are satisfied</summary>
<p>By Crandall-Majda, we have that <span class="arithmatex">\(K\)</span> is bounded in <span class="arithmatex">\(L^1(\R)\)</span> by <span class="arithmatex">\(\norm{U_0}_{L^1(\R)}\)</span>. We have also shown that the scheme is TVD, so <span class="arithmatex">\(K \subset BV(\R)\)</span>.</p>
<p>For the second part of the theorem, we have that <span class="arithmatex">\(U_0 \in L^1(\R)\)</span>, so</p>
<div class="arithmatex">\[\forall \eps &gt; 0 \exists\, r &gt; 0 : \left\{\begin{aligned}
    &amp; \abs{U_0(x)} \le \eps \quad \forall \abs{x} &gt; r, \\
    &amp; \int_{\R \setminus [-r, r]} \abs{U_0(x)} \dd x \le \eps.
\end{aligned}\right.\]</div>
<p>Additionally, by monotinicity, we have that</p>
<div class="arithmatex">\[\min\qty{U_{j-1}^n, U_j^n, U_{j+1}^n} \le U_j^{n+1} \le \max\qty{U_{j-1}^n, U_j^n, U_{j+1}^n}, \quad \forall n, j.\]</div>
<p>So, propagating at the speed <span class="arithmatex">\(1/c\)</span>, we get that</p>
<div class="arithmatex">\[\UDx(x, t) \le \eps \quad \forall \abs{x} &gt; R, t\in[0, T],\]</div>
<p>where <span class="arithmatex">\(R = r + T/c\)</span>. Next, let <span class="arithmatex">\(J \in \N\)</span> be such that <span class="arithmatex">\(R \in \Cell_J\)</span>. Then, we sum the discrete entropy inequality <span class="arithmatex">\(\eqref{eq:discrete_entropy_inequality}\)</span> over <span class="arithmatex">\(\abs{j} &gt; J\)</span> and over <span class="arithmatex">\(n=0,\dots,N\)</span> for <span class="arithmatex">\(k=0\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
    \sum_{\abs{j} &gt; J} \sum_{n=0}^N \qty(\abs{U_j^{n+1}} - \abs{U_j^n})
    + \frac{\Dt}{\Dx} \sum_{\abs{j} &gt; J} \sum_{n=0}^N \qty(Q_{j+1/2}^n - Q_{j-1/2}^n)
    &amp; \le 0 \\
    \sum_{\abs{j} &gt; J} \qty(\abs{U_j^{N+1}} - \abs{U_j^0})
    + \frac{\Dt}{\Dx} \sum_{n=0}^N \qty(Q_{-J-1/2}^n - Q_{J+1/2}^n)
    &amp;\le 0
\end{aligned}
\]</div>
<p>Now, <span class="arithmatex">\(U_j^0\)</span> is the cell average of <span class="arithmatex">\(U_0\)</span>, so we further get the bound</p>
<div class="arithmatex">\[\Dx\sum_{\abs{j} &gt; J} \abs{U_j^{N+1}}
\le \int_{\R \setminus [-R, R]} \abs{U_0} \dd x
+ \Dt \sum_{n=0}^N \qty(\abs{Q_{-J-1/2}^n} + \abs{Q_{J+1/2}^n}).\]</div>
<p>Finally, for <span class="arithmatex">\(t \in [t^m, t^{m+1})\)</span>, we have</p>
<div class="arithmatex">\[
\begin{aligned}
    \int_{\R \setminus [-R, R]} \abs{\UDx} \dd x
    &amp;\le \Dx \sum_{\abs{j} &gt; J} \qty(\abs{U_j^m} + \abs{U_j^{m+1}}) \\
    &amp;\le 2\int_{\R \setminus [-R, R]} \abs{U_0} \dd x
    + 2\Dt \sum_{n=0}^m \qty(\abs{Q_{-J-1/2}^n} + \abs{Q_{J+1/2}^n}) \\
    &amp;\le 2\eps + 2\Dt \sum_{n=0}^N \qty(\abs{Q_{-J-1/2}^n} + \abs{Q_{J+1/2}^n}).
\end{aligned}
\]</div>
<details class="claim">
<summary>Claim: <span class="arithmatex">\(\abs{Q_{\pm J \pm 1/2}^n} \le 2C_F\eps\)</span></summary>
<p>Recall that <span class="arithmatex">\(F\)</span> is Lipschitz continuous, so</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1"><span class="arithmatex">\(\sign{U_J^n} = \sign{U_{J+1}^n}\)</span></label><label for="__tabbed_5_2"><span class="arithmatex">\(\sign{U_J^n} \neq \sign{U_{J+1}^n}\)</span></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="arithmatex">\[
\begin{aligned}
    \abs{Q_{J+1/2}^n} &amp;= \abs{F(U_J^n, U_{J+1}^n) - F(0, 0)} \\
    &amp; \le \abs{F(U_J^n, U_{J+1}^n) - F(U_J^n, 0)} + \abs{F(U_J^n, 0) - F(0, 0)} \\
    &amp; \le C_F \qty(\abs{U_{J+1}^n} + \abs{U_J^n})
\end{aligned}
\]</div>
</div>
<div class="tabbed-block">
<div class="arithmatex">\[
\begin{aligned}
    \abs{Q_{J+1/2}^n} &amp;= \abs{F(U_J^n, 0) - F(0, U_{J+1}^n)} \\
    &amp; \le \abs{F(U_J^n, 0) - F(0, 0)} + \abs{F(0, 0) - F(0, U_{J+1}^n)} \\
    &amp; \le C_F \qty(\abs{U_J^n} + \abs{U_{J+1}^n}).
\end{aligned}
\]</div>
</div>
</div>
</div>
<p>Similarly for <span class="arithmatex">\(Q_{-J-1/2}^n\)</span>. Recall further that <span class="arithmatex">\(J\)</span> is chosen such that <span class="arithmatex">\(U_J^n, U_{J+1}^n \le \eps\)</span> for all <span class="arithmatex">\(n\)</span>. Hence, we get the desired result.</p>
</details>
<p>Then, we get the bound</p>
<div class="arithmatex">\[\int_{\R \setminus [-R, R]} \abs{\UDx} \dd x \le 2\eps \qty(1 + 4C_F T)\]</div>
<p>independent of <span class="arithmatex">\(t\)</span> and <span class="arithmatex">\(\Dx\)</span>. This proves the claim.</p>
</details>
<p>So <span class="arithmatex">\(K\)</span> is relatively compact in <span class="arithmatex">\(L^1(\R)\)</span>. Then, by Ascoli's theorem, there exists a subsequence <span class="arithmatex">\(\Dx'\)</span> and <span class="arithmatex">\(U \in L^1(\R \times [0, T])\)</span> such that <span class="arithmatex">\(\UDx{}^{'} \to U\)</span>. By Lax-Wendroff, <span class="arithmatex">\(U\)</span> is the entropy solution.</p>
</details>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/math_tooltips.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>